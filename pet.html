<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grok梦工厂 - 虚拟宠物乐园 🐾</title>
    <style>
        /* 统一霓虹科幻主题 + 宠物可爱风 */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Arial Black', sans-serif;
            background: linear-gradient(45deg, #ff9a9e, #fad0c4, #fad0c4);
            color: #333; min-height: 100vh; overflow: hidden;
            animation: bgPulse 15s infinite alternate;
        }
        @keyframes bgPulse { 0% { background-position: 0% 50%; } 100% { background-position: 100% 50%; } }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; text-align: center; }
        h1 { font-size: 3em; text-shadow: 0 0 20px #ff6b9d; margin: 20px 0; animation: glow 2s infinite; }
        @keyframes glow { 0%,100%{text-shadow:0 0 20px #ff6b9d;} 50%{text-shadow:0 0 40px #fecfef;} }
        .back { position: absolute; top: 20px; left: 20px; color: #ff6b9d; font-size: 1.2em; text-decoration: none; z-index: 10; }
        .back:hover { text-shadow: 0 0 20px #fff; }
        #petCanvas { width: 100%; max-width: 500px; height: 500px; border: 8px solid #fecfef; border-radius: 50%; 
                     box-shadow: 0 20px 60px rgba(255,107,157,0.5); margin: 30px auto; cursor: grab; }
        #petCanvas:active { cursor: grabbing; }
        .stats { display: flex; justify-content: center; gap: 20px; margin: 20px 0; flex-wrap: wrap; }
        .stat { background: rgba(255,255,255,0.8); padding: 15px 25px; border-radius: 50px; font-size: 1.3em; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .mood { font-weight: bold; color: #ff6b9d; }
        button { padding: 18px 35px; font-size: 1.4em; background: linear-gradient(45deg, #ff9a9e, #fecfef);
                 border: none; border-radius: 50px; color: #fff; cursor: pointer; margin: 10px;
                 transition: all 0.3s; box-shadow: 0 10px 30px rgba(255,154,158,0.5); }
        button:hover { transform: scale(1.1) rotate(3deg); box-shadow: 0 20px 50px rgba(255,107,157,0.8); }
        button:active { animation: bounce 0.4s; }
        @keyframes bounce { 0%,100%{transform:scale(1.1);} 50%{transform:scale(0.95);} }
        #chatInput { width: 70%; padding: 15px; font-size: 1.3em; border: 3px solid #fecfef; border-radius: 50px; margin: 20px 0; }
        #chatLog { height: 150px; overflow-y: auto; background: rgba(255,255,255,0.7); border-radius: 20px; padding: 15px; margin: 20px 0; text-align: left; font-size: 1.2em; }
        .particles { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 100; }
        .particle { position: absolute; width: 6px; height: 6px; background: #ff9a9e; border-radius: 50%; animation: heart 2s forwards; }
        @keyframes heart { to { opacity: 0; transform: translateY(-100vh) scale(2) rotate(360deg); } }
        footer { margin-top: 40px; font-size: 1.1em; opacity: 0.8; color: #ff6b9d; }
        @media (max-width: 600px) { h1 { font-size: 2.2em; } #chatInput { width: 90%; } .stats { flex-direction: column; } }
    </style>
</head>
<body>
    <a href="index.html" class="back">← 返回梦工厂</a>
    <div class="container">
        <h1>🐾 Grok虚拟宠物乐园</h1>
        <p style="font-size:1.5em; margin-bottom:30px;">领养你的AI宠物！抚摸、喂食、聊天 → 进化神兽！</p>
        
        <canvas id="petCanvas" width="500" height="500"></canvas>
        
        <div class="stats">
            <div class="stat">❤️ 生命: <span id="hp">100</span></div>
            <div class="stat">🍔 饱食: <span id="food">80</span></div>
            <div class="stat">😊 心情: <span id="mood" class="mood">开心</span></div>
            <div class="stat">🌟 等级: <span id="level">1</span></div>
        </div>
        
        <button onclick="feed()">🍖 喂食</button>
        <button onclick="pet()">✋ 抚摸</button>
        <button onclick="play()">🎾 玩耍</button>
        <button onclick="resetPet()">🔄 重新领养</button>
        
        <input type="text" id="chatInput" placeholder="和宠物聊天... (e.g. 你好可爱)" onkeypress="if(event.key==='Enter') chat()">
        <button onclick="chat()">💬 发送</button>
        
        <div id="chatLog"></div>
        
        <footer>© 2025 Grok梦工厂 | <a href="https://grokdream.fun" style="color:#ff6b9d;">grokdream.fun</a> | 宠物永不离线！</footer>
    </div>
    
    <div class="particles" id="particles"></div>

    <script>
        /* JS核心：3D宠物渲染 + 情感AI + 本地存档 + 粒子爱心 */
        const canvas = document.getElementById('petCanvas');
        const ctx = canvas.getContext('2d');
        const particlesDiv = document.getElementById('particles');
        
        let pet = { hp: 100, food: 80, mood: '开心', level: 1, name: 'Grok宝宝', color: '#ff6b9d', shape: 'round' };
        let rotation = 0;
        let isDragging = false, lastX = 0;
        
        /* 加载存档 */
        function loadPet() {
            const saved = localStorage.getItem('grokPet');
            if (saved) pet = JSON.parse(saved);
            updateStats();
            renderPet();
            animate();
        }
        function savePet() { localStorage.setItem('grokPet', JSON.stringify(pet)); }
        
        /* 领养新宠物 */
        function resetPet() {
            pet = {
                hp: 100, food: 80, mood: '开心', level: 1,
                name: ['Grok宝宝','量子喵','黑洞汪','星际龙'][Math.floor(Math.random()*4)],
                color: `hsl(${Math.random()*360}, 100%, 70%)`,
                shape: ['round','star','heart','triangle'][Math.floor(Math.random()*4)]
            };
            savePet(); loadPet();
            addChat('系统', `🎉 你领养了 <b>${pet.name}</b>！快和TA玩吧~`);
        }
        
        /* 互动 */
        function feed() { pet.food = Math.min(100, pet.food + 20); updateMood(); createParticles(20); }
        function petAction() { pet.mood = '超开心'; pet.hp = Math.min(100, pet.hp + 10); createParticles(30); }
        function play() { pet.food = Math.max(0, pet.food - 15); updateMood(); createParticles(25); }
        
        function pet() { petAction(); addChat(pet.name, randomResponse('pet')); }
        function feed() { petAction(); addChat(pet.name, randomResponse('feed')); }
        function play() { petAction(); addChat(pet.name, randomResponse('play')); }
        
        /* 情感AI回应 */
        function chat() {
            const input = document.getElementById('chatInput').value.trim();
            if (!input) return;
            addChat('你', input);
            const response = generateResponse(input);
            setTimeout(() => addChat(pet.name, response), 800);
            document.getElementById('chatInput').value = '';
            createParticles(15);
        }
        
        function generateResponse(input) {
            const lowers = input.toLowerCase();
            if (lowers.includes('爱') || lowers.includes('喜欢')) return '❤️ 我也爱你！永远不分开！';
            if (lowers.includes('饿') || lowers.includes('吃')) return '🍔 快喂我！我要吃量子披萨！';
            if (lowers.includes('玩') || lowers.includes('游戏')) return '🎾 耶！来追我呀~';
            if (lowers.includes('名字')) return `🐾 我是${pet.name}！独一无二！`;
            return ['😊 嘻嘻！', '🐾 喵呜~', '✨ 好玩！', '❤️ 抱抱！'][Math.floor(Math.random()*4)];
        }
        
        function randomResponse(type) {
            const res = {
                pet: ['❤️ 好舒服~', '😊 再摸摸！', '✨ 毛好顺！'],
                feed: ['🍖 好吃！', '😋 饱了！', '⚡ 能量满！'],
                play: ['🎾 接球！', '🏃 跑起来！', '🎉 太开心！']
            };
            return res[type][Math.floor(Math.random()*3)];
        }
        
        /* 更新状态 */
        function updateMood() {
            if (pet.food > 70) pet.mood = '超开心';
            else if (pet.food > 40) pet.mood = '开心';
            else if (pet.food > 20) pet.mood = '饿了';
            else pet.mood = '生气';
            if (pet.food <= 0) pet.hp = Math.max(0, pet.hp - 1);
            updateStats(); savePet();
        }
        
        function updateStats() {
            document.getElementById('hp').textContent = pet.hp;
            document.getElementById('food').textContent = pet.food;
            document.getElementById('mood').textContent = pet.mood;
            document.getElementById('level').textContent = pet.level;
        }
        
        /* 聊天记录 */
        function addChat(sender, msg) {
            const log = document.getElementById('chatLog');
            const div = document.createElement('div');
            div.innerHTML = `<b>${sender}:</b> ${msg}`;
            div.style.margin = '8px 0';
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
        }
        
        /* 3D宠物渲染 */
        function renderPet() {
            ctx.clearRect(0, 0, 500, 500);
            ctx.save();
            ctx.translate(250, 250);
            ctx.rotate(rotation * Math.PI / 180);
            
            // 身体
            ctx.fillStyle = pet.color;
            if (pet.shape === 'round') ctx.beginPath(), ctx.arc(0, 0, 120, 0, Math.PI*2);
            else if (pet.shape === 'star') drawStar(ctx, 0, 0, 5, 130, 60);
            else if (pet.shape === 'heart') drawHeart(ctx, 0, 0, 120);
            else drawTriangle(ctx, 0, 0, 140);
            ctx.fill();
            ctx.strokeStyle = '#fff'; ctx.lineWidth = 8; ctx.stroke();
            
            // 眼睛
            ctx.fillStyle = '#000';
            ctx.beginPath(); ctx.arc(-40, -30, 25, 0, Math.PI*2); ctx.fill();
            ctx.beginPath(); ctx.arc(40, -30, 25, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.beginPath(); ctx.arc(-35, -35, 10, 0, Math.PI*2); ctx.fill();
            ctx.beginPath(); ctx.arc(45, -35, 10, 0, Math.PI*2); ctx.fill();
            
            // 嘴巴
            ctx.strokeStyle = '#000'; ctx.lineWidth = 6;
            ctx.beginPath(); ctx.arc(0, 20, 40, 0, Math.PI * (pet.mood.includes('开心') ? 0.7 : 0.3)); ctx.stroke();
            
            ctx.restore();
        }
        
        function drawStar(ctx, x, y, spikes, outer, inner) {
            let rot = Math.PI / 2 * 3, step = Math.PI / spikes;
            ctx.beginPath(); ctx.moveTo(x, y - outer);
            for (let i = 0; i < spikes; i++) {
                ctx.lineTo(x + Math.cos(rot) * outer, y + Math.sin(rot) * outer);
                rot += step;
                ctx.lineTo(x + Math.cos(rot) * inner, y + Math.sin(rot) * inner);
                rot += step;
            }
            ctx.closePath();
        }
        
        function drawHeart(ctx, x, y, size) {
            ctx.beginPath();
            ctx.moveTo(x, y + size/4);
            ctx.bezierCurveTo(x, y, x - size/2, y, x - size/2, y + size/4);
            ctx.bezierCurveTo(x - size/2, y + size/2, x, y + size*0.9, x, y + size);
            ctx.bezierCurveTo(x, y + size*0.9, x + size/2, y + size/2, x + size/2, y + size/4);
            ctx.bezierCurveTo(x + size/2, y, x, y, x, y + size/4);
            ctx.closePath();
        }
        
        function drawTriangle(ctx, x, y, size) {
            ctx.beginPath();
            ctx.moveTo(x, y - size);
            ctx.lineTo(x - size*0.866, y + size/2);
            ctx.lineTo(x + size*0.866, y + size/2);
            ctx.closePath();
        }
        
        /* 动画循环 */
        function animate() {
            renderPet();
            requestAnimationFrame(animate);
        }
        
        /* 拖拽旋转 */
        canvas.addEventListener('mousedown', e => { isDragging = true; lastX = e.clientX; });
        canvas.addEventListener('mousemove', e => {
            if (isDragging) {
                const delta = e.clientX - lastX;
                rotation += delta * 0.5;
                lastX = e.clientX;
            }
        });
        canvas.addEventListener('mouseup', () => isDragging = false);
        canvas.addEventListener('mouseleave', () => isDragging = false);
        
        /* 粒子爱心 */
        function createParticles(count) {
            for (let i = 0; i < count; i++) {
                const p = document.createElement('div'); p.className = 'particle';
                p.style.left = Math.random() * 100 + 'vw';
                p.style.top = '100vh';
                p.style.animationDelay = Math.random() * 0.5 + 's';
                particlesDiv.appendChild(p);
                setTimeout(() => p.remove(), 2000);
            }
        }
        
        /* 定时更新 */
        setInterval(() => {
            pet.food = Math.max(0, pet.food - 1);
            updateMood();
        }, 3000);
        
        /* 初始化 */
        loadPet();
        setInterval(() => createParticles(3), 2000);
    </script>
</body>
</html>